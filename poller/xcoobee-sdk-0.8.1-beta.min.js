var XcooBee=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=15)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.appearsToBeACursor=u,t.appearsToBeAnEmailAddress=s,t.assertAppearsToBeACampaignId=c,t.createClient=f,t.transformError=l;var n=r(29),o=function(e){return e&&e.__esModule?e:{default:e}}(r(1));var i=/^[\w/=+]+$/,a=/^[-+\w]+(\.[-+\w]+)*@([-a-z0-9]+\.)+[a-z]{2,6}$/i;function u(e){return i.test(e)}function s(e){return a.test(e)}function c(e){if(!function(e){return"string"==typeof e&&e.length>0}(e))throw new o.default("Campaign ID is required")}function f(e,t){var r=e+"/graphql";return new n.GraphQLClient(r,{headers:{Authorization:""+t}})}function l(e){if(e instanceof o.default)return e;var t=0;if(e.response&&"number"==typeof e.response.status&&(t=e.response.status),401===t)return new o.default("401 Unauthorized.  Please make sure your API access token is fresh.");if(e.response&&e.response.errors){var r=e.response.errors;Array.isArray(r)||(r=[r]);var n=r.map(p).join("\n");return new o.default(n)}return new o.default(e)}function p(e){var t=[];return e.message&&t.push(e.message),e.locations&&t.push(e.locations.map(d).join(", ")),0===t.length&&t.push(JSON.stringify(e)),t=t.join(" ")}function d(e){return"at line: "+e.line+", column: "+e.column}t.default={appearsToBeACursor:u,appearsToBeAnEmailAddress:s,assertAppearsToBeACampaignId:c,createClient:f,transformError:l}},function(e,t,r){"use strict";function n(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));return Error.captureStackTrace(i,t),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n(Error)),t}();o.prototype.name="XcooBeeError",t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(7));var o=function(e){function t(e,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{code:e,error:r}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n.default),t}();t.default=o},function(e,t,r){"use strict"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(){var e=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(o,i){try{var a=t[o](i),u=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}(regeneratorRuntime.mark(function e(t,r,o){var u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t(r,n({},o,{after:null}));case 3:return u=e.sent,s=new a.default(t,u,r,o),e.abrupt("return",s);case 8:throw e.prev=8,e.t0=e.catch(0),new i.default(400,e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(t,r,n){return e.apply(this,arguments)}}(),i=u(r(2)),a=u(r(40));function u(e){return e&&e.__esModule?e:{default:e}}t.default={resolveApiCfg:function(e,t){return e&&"apiKey"in e&&"apiSecret"in e&&"apiUrlRoot"in e?{apiKey:e.apiKey,apiSecret:e.apiSecret,apiUrlRoot:e.apiUrlRoot}:t&&"apiKey"in t&&"apiSecret"in t&&"apiUrlRoot"in t?{apiKey:t.apiKey,apiSecret:t.apiSecret,apiUrlRoot:t.apiUrlRoot}:null},resolveCampaignId:function(e,t,r){return e&&"string"==typeof e?e:t&&"string"==typeof t.campaignId?t.campaignId:r&&"string"==typeof r.campaignId?r.campaignId:null},startPaging:o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(7));var o=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{code:200,error:null,result:e}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n.default),t}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.BEE_ICON="bee_icon",o=t.INVITE_LIST="invite_list",i=t.OUTBOX="outbox",a=t.PROFILE_IMAGE="profile_image",u=Object.freeze([n,o,i,a]),s=Object.freeze({BEE_ICON:n,INVITE_LIST:o,OUTBOX:i,PROFILE_IMAGE:a,values:u});t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw TypeError("Response `info` is required.");if(t.code<200||t.code>599)throw TypeError("`code` must be a valid HTTP status code.");if(t.code<300){if(null===t.result||void 0===t.result)throw TypeError("`result` is required for successful responses.")}else{if(null===t.error||void 0===t.error)throw TypeError("`error` is required for non-successful responses.");if(null===t.error.message||void 0===t.error.message)throw TypeError("`error.message` is required for non-successful responses.")}this._=n({},t,{time:new Date})}return o(e,[{key:"getNextPage",value:function(){var e=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(o,i){try{var a=t[o](i),u=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"hasNextPage",value:function(){return!!this._.hasNextPage}},{key:"code",get:function(){return this._.code}},{key:"result",get:function(){return this._.result}},{key:"error",get:function(){return this._.error}},{key:"time",get:function(){return this._.time}}]),e}();t.default=i},function(e,t,r){"use strict";e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw TypeError("Config `data` is required.");var r=t.apiKey,n=t.apiSecret,o=t.apiUrlRoot,i=t.campaignId,a=t.encrypt,u=t.pgpPassword,s=t.pgpSecret;if(i=void 0===i?null:i,a=void 0!==a&&a,u=void 0===u?null:u,s=void 0===s?null:s,!r||"string"!=typeof r)throw new TypeError("API key is required.");if(!n||"string"!=typeof n)throw new TypeError("API secret is required.");if(!o||"string"!=typeof o)throw new TypeError("API URL root is required.");if(null!==i&&"string"!=typeof i||"string"==typeof i&&0===i.length)throw new TypeError("Default campaign ID must be null or a valid campaign ID.");if(a){if(!u)throw new TypeError("PGP password is required when encrypt is true.");if(!s)throw new TypeError("PGP secret is required when encrypt is true.")}this._={apiKey:r,apiSecret:n,apiUrlRoot:o,campaignId:i,encrypt:a,pgpPassword:u,pgpSecret:s}}return n(e,[{key:"apiKey",get:function(){return this._.apiKey}},{key:"apiSecret",get:function(){return this._.apiSecret}},{key:"apiUrlRoot",get:function(){return this._.apiUrlRoot}},{key:"campaignId",get:function(){return this._.campaignId}},{key:"encrypt",get:function(){return this._.encrypt}},{key:"pgpPassword",get:function(){return this._.pgpPassword}},{key:"pgpSecret",get:function(){return this._.pgpSecret}}]),e}();t.default=o},function(e,t,r){"use strict";var n=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(r,n){var o=this,i=t.extractMessage(r)+": "+JSON.stringify({response:r,request:n});return(o=e.call(this,i)||this).response=r,o.request=n,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(o,t),o}return n(t,e),t.extractMessage=function(e){try{return e.errors[0].message}catch(t){return"GraphQL Error (Code: "+e.status+")"}},t}(Error);t.ClientError=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addDirective=o;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0));function o(e,t,r){return n.default.createClient(e,t).request("\n    mutation addDirective($directiveInput: DirectiveInput!) {\n      add_directive(params: $directiveInput) {\n        ref_id\n      }\n    }\n  ",{directiveInput:r}).then(function(e){return e.add_directive.ref_id}).catch(function(e){throw n.default.transformError(e)})}t.default={addDirective:o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){var e=s(regeneratorRuntime.mark(function e(t,r,n,u,f){var l,p,d,h,_,y,v,g,m=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.default.findEndPoint(t,r,n,u,"flex");case 2:if(l=e.sent){e.next=5;break}throw new XcooBeeError('Unable to find an endpoint named "'+u+'" or "flex".');case 5:return p=u,d=l.cursor,e.next=9,a.default.upload_policy(t,r,p,d,f);case 9:return h=e.sent,_=c(f,h),y=_.map(function(e){var t=e.file,r=e.policy;return i.default.upload_file(t,r)}),e.next=14,new Promise(function(e){e(y.map(function(){var e=s(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,e.prev=1,e.next=4,t;case 4:r=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),r=e.t0;case 10:return e.abrupt("return",r);case 11:case"end":return e.stop()}},e,m,[[1,7]])}));return function(t){return e.apply(this,arguments)}}()))});case 14:return v=e.sent,g=_.map(function(e,t){var r=e.file,n=v[t];return n instanceof Error?{success:!1,error:n,file:r}:{success:!0,file:r}}),e.abrupt("return",g);case 17:case"end":return e.stop()}},e,this)}));return function(t,r,n,o,i){return e.apply(this,arguments)}}(),o=u(r(35)),i=u(r(37)),a=u(r(39));function u(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(o,i){try{var a=t[o](i),u=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}function c(e,t){for(var r=[],n=Math.max(e.length,t.length),o=0;o<n;++o){var i=e[o]||null,a=t[o]||null;r.push({file:i,policy:a})}return r}t.default={upload:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCampaignInfo=o,t.getCampaigns=i;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0));function o(e,t,r){n.default.assertAppearsToBeACampaignId(r);return n.default.createClient(e,t).request("\n    query getCampaignInfo($campaignId: String!) {\n      campaign(campaign_cursor: $campaignId) {\n        campaign_description {\n          text\n        }\n        campaign_name\n        campaign_title {\n          text\n        }\n        date_c\n        date_e\n        email_targets {\n          email\n        }\n        endpoint\n        status\n        targets {\n          name\n          recipient\n        }\n        xcoobee_targets {\n          xcoobee_id\n        }\n      }\n    }\n  ",{campaignId:r}).then(function(e){return{campaign:e.campaign}}).catch(function(e){throw n.default.transformError(e)})}function i(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return n.default.createClient(e,t).request("\n    query getCampaigns($userCursor: String!, $after: String, $first: Int) {\n      campaigns(user_cursor: $userCursor, after: $after, first: $first) {\n        data {\n          campaign_cursor\n          campaign_name\n          status\n        }\n        page_info {\n          end_cursor\n          has_next_page\n        }\n      }\n    }\n  ",{after:o,first:i,userCursor:r}).then(function(e){return e.campaigns}).catch(function(e){throw n.default.transformError(e)})}t.default={getCampaignInfo:o,getCampaigns:i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getConversation=a,t.getConversations=u,t.sendUserMessage=s;var n=i(r(0)),o=i(r(46));function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return n.default.createClient(e,t).request("\n    query getConversation($targetCursor: String!, $after: String, $first: Int) {\n      conversation(target_cursor: $targetCursor, after: $after, first: $first) {\n        data {\n          breach_cursor\n          consent_cursor\n          date_c\n          date_e\n          display_city\n          display_country\n          display_name\n          display_province\n          is_outbound\n          note_text\n          note_type\n          photo_url\n          xcoobee_id\n        }\n        page_info {\n          end_cursor\n          has_next_page\n        }\n      }\n    }\n  ",{after:o,first:i,targetCursor:r}).then(function(e){return e.conversation}).catch(function(e){throw n.default.transformError(e)})}function u(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return n.default.createClient(e,t).request("\n    query getConversations($userCursor: String!, $after: String, $first: Int) {\n      conversations(user_cursor: $userCursor, after: $after, first: $first) {\n        data {\n          date_c\n          display_name\n          note_type\n          target_cursor\n        }\n        page_info {\n          end_cursor\n          has_next_page\n        }\n      }\n    }\n  ",{after:o,first:i,userCursor:r}).then(function(e){return e.conversations}).catch(function(e){throw n.default.transformError(e)})}function s(e,t,r,i,a,u){var s=u?o.default.BREACH:o.default.CONSENT;return n.default.createClient(e,t).request("\n    mutation sendUserMessage($config: SendMessageConfig) {\n      send_message(config: $config) {\n        date_c\n        date_e\n        note_text\n        target_cursor\n        xcoobee_id\n      }\n    }\n  ",{config:{breach_cursor:u,consent_cursor:a,message:r,note_type:s,user_cursor:i}}).then(function(e){return e.send_message}).catch(function(e){throw n.default.transformError(e)})}t.default={getConversation:a,getConversations:u,sendUserMessage:s}},function(e,t,r){r(16),e.exports=r(17)},function(e,t,r){"use strict";(function(e){var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(r){var n,o=Object.prototype,i=o.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag",f="object"===t(e),l=r.regeneratorRuntime;if(l)f&&(e.exports=l);else{(l=r.regeneratorRuntime=f?e.exports:{}).wrap=E;var p="suspendedStart",d="suspendedYield",h="executing",_="completed",y={},v={};v[u]=function(){return this};var g=Object.getPrototypeOf,m=g&&g(g(N([])));m&&m!==o&&i.call(m,u)&&(v=m);var b=O.prototype=C.prototype=Object.create(v);T.prototype=b.constructor=O,O.constructor=T,O[c]=T.displayName="GeneratorFunction",l.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===T||"GeneratorFunction"===(t.displayName||t.name))},l.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,O):(e.__proto__=O,c in e||(e[c]="GeneratorFunction")),e.prototype=Object.create(b),e},l.awrap=function(e){return{__await:e}},A(I.prototype),I.prototype[s]=function(){return this},l.AsyncIterator=I,l.async=function(e,t,r,n){var o=new I(E(e,t,r,n));return l.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},A(b),b[c]="Generator",b[u]=function(){return this},b.toString=function(){return"[object Generator]"},l.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},l.values=N,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,o){return u.type="throw",u.arg=e,t.next=r,o&&(t.method="next",t.arg=n),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),x(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:N(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),y}}}function E(e,t,r,n){var o=t&&t.prototype instanceof C?t:C,i=Object.create(o.prototype),a=new P(n||[]);return i._invoke=function(e,t,r){var n=p;return function(o,i){if(n===h)throw new Error("Generator is already running");if(n===_){if("throw"===o)throw i;return k()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=R(a,r);if(u){if(u===y)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===p)throw n=_,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=h;var s=w(e,t,r);if("normal"===s.type){if(n=r.done?_:d,s.arg===y)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n=_,r.method="throw",r.arg=s.arg)}}}(e,r,a),i}function w(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function C(){}function T(){}function O(){}function A(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function I(e){var r;this._invoke=function(n,o){function a(){return new Promise(function(r,a){!function r(n,o,a,u){var s=w(e[n],e,o);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"===(void 0===f?"undefined":t(f))&&i.call(f,"__await")?Promise.resolve(f.__await).then(function(e){r("next",e,a,u)},function(e){r("throw",e,a,u)}):Promise.resolve(f).then(function(e){c.value=e,a(c)},u)}u(s.arg)}(n,o,r,a)})}return r=r?r.then(a,a):a()}}function R(e,t){var r=e.iterator[t.method];if(r===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,R(e,t),"throw"===t.method))return y;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=w(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,y;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,y):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,y)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function N(e){if(e){var t=e[u];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}return{next:k}}function k(){return{value:n,done:!0}}}(function(){return this}()||Function("return this")())}).call(this,r(8)(e))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sdk=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(18));var o={sdk:t.sdk=n.default};t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(9)),o=a(r(19)),i=a(r(22));function a(e){return e&&e.__esModule?e:{default:e}}t.default={Config:n.default,ConfigUtils:o.default,Sdk:i.default}},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.createConfigFromFile=c;var n=s(r(3)),o=s(r(3)),i=s(r(3)),a=r(21),u=s(r(9));function s(e){return e&&e.__esModule?e:{default:e}}function c(t){void 0===t&&((t=e.env.HOME)||(t=e.env.USERPROFILE));var r=o.default.join(t,".xcoobee","config");return new Promise(function(e,s){var c={};try{var f=n.default.createReadStream(r);f.on("error",function(e){s(e)});var l=i.default.createInterface({input:f});l.on("line",function(e){var t=e.trim();if(t.length>0){var r=t.split("#")[0].trim();if(r.length>0){var n=r.split("="),o=n[0].trim(),i=(n[1]||"").trim();c[o]=i}}}),l.on("close",function(){if("campaignId"in c&&""===campaignId&&(c.campaignId=null),"encrypt"in c&&(c.encrypt=(0,a.toBool)(c.encrypt,!1)),"pgpPassword"in c&&""===pgpPassword&&(c.pgpPassword=null),"pgpSecret"in c&&""===pgpSecret&&(c.pgpSecret=null),"pgpSecret"in c)e(new u.default(c));else{var r=o.default.join(t,".xcoobee","pgp.secret");n.default.readFile(r,function(t,r){if(t){if("ENOENT"===t.code)return void e(new u.default(c));s(t)}else c.pgpSecret=r,e(new u.default(c))})}})}catch(e){s(e)}})}var f={createFromFile:c};t.default=f}).call(this,r(20))},function(e,t,r){"use strict";var n,o,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{o="function"==typeof clearTimeout?clearTimeout:u}catch(e){o=u}}();var c,f=[],l=!1,p=-1;function d(){l&&c&&(l=!1,c.length?f=c.concat(f):p=-1,f.length&&h())}function h(){if(!l){var e=s(d);l=!0;for(var t=f.length;t;){for(c=f,f=[];++p<t;)c&&c[p].run();p=-1,t=f.length}c=null,l=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===u||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function y(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];f.push(new _(e,t)),1!==f.length||l||s(h)},_.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.__esModule=!0;var o={0:!1,1:!0,f:!1,t:!0,n:!1,y:!0,on:!0,off:!1,no:!1,yes:!0,false:!1,true:!0};function i(e){var t,r;return void 0!==e&&null!==e&&"function"==typeof e.valueOf&&((t=e.valueOf())&&"function"==typeof t.toString&&(t=t.toString().toLowerCase()),r=o[t]),r}var a={converter:i};function u(e,t){var r;return"boolean"==typeof e?r=e:"boolean"!=typeof(r=a.converter(e))&&(void 0===(t="object"==(void 0===t?"undefined":n(t))&&null!==t&&t.hasOwnProperty("def")?t.def:t)&&(t=e),r=t),r}t.toBool=u,function(e){e.resetConverter=function(){a.converter=i},e.setConverter=function(e){a.converter=e}}(u||(u={})),t.toBool=u,t.toBoolOrNull=function(e){return u(e,null)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=l(r(23)),i=l(r(31)),a=l(r(33)),u=l(r(41)),s=l(r(47)),c=l(r(49)),f=l(r(52));function l(e){return e&&e.__esModule?e:{default:e}}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=t||null,n=new o.default,l=new i.default(n);this._={bees:new a.default(r,n,l),config:r,consents:new u.default(r,n,l),inbox:new s.default(r,n,l),system:new c.default(r,n,l),users:new f.default(r,n,l)}}return n(e,[{key:"bees",get:function(){return this._.bees}},{key:"config",get:function(){return this._.config},set:function(e){this._.bees.config=e,this._.consents.config=e,this._.inbox.config=e,this._.system.config=e,this._.users.config=e,this._.config=e}},{key:"consents",get:function(){return this._.consents}},{key:"inbox",get:function(){return this._.inbox}},{key:"system",get:function(){return this._.system}},{key:"users",get:function(){return this._.users}}]),e}();t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=u(r(24)),a=u(r(27));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._={cfg:n({},t||{}),internalCache:{}}}return o(e,[{key:"get",value:function(e,t,r,n){var o=this;if(!e)throw TypeError("apiUrlRoot is required.");if(!t)throw TypeError("apiKey is required.");if(!r)throw TypeError("apiSecret is required.");if("string"!=typeof e)throw TypeError("apiUrlRoot must be a string.");if("string"!=typeof t)throw TypeError("apiKey must be a string.");if("string"!=typeof r)throw TypeError("apiSecret must be a string.");var u=e+":"+t+":"+r;if(!0!==n&&u in this._.internalCache){var s=this._.internalCache[u],c=(0,i.default)(s).exp,f=Date.now();if(("number"==typeof c&&c==c?1e3*c:f)-f>(this._.cfg.expTol||1e4))return Promise.resolve(s)}return a.default.getApiAccessToken({apiKey:t,apiSecret:r,apiUrlRoot:e}).then(function(e){return o._.internalCache[u]=e,e})}}]),e}();t.default=s},function(e,t,r){"use strict";var n=r(25);function o(e){this.message=e}o.prototype=new Error,o.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new o("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(n(e.split(".")[r]))}catch(e){throw new o("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=o},function(e,t,r){"use strict";var n=r(26);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(n(e).replace(/(.)/g,function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}(t)}catch(e){return n(t)}}},function(e,t,r){"use strict";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function o(e){this.message=e}o.prototype=new Error,o.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new o("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,i,a=0,u=0,s="";i=t.charAt(u++);~i&&(r=a%4?64*r+i:i,a++%4)?s+=String.fromCharCode(255&r>>(-2*a&6)):0)i=n.indexOf(i);return s}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getApiAccessToken=s;var n=a(r(28)),o=a(r(1)),i=a(r(0));function a(e){return e&&e.__esModule?e:{default:e}}var u="Unable to get an API access token.";function s(e){var t=e.apiKey,r=e.apiSecret,a=e.apiUrlRoot,c=t+":"+r;if(c in s._.unfulfilledPromises)return s._.unfulfilledPromises[c];var f=new Promise(function(e,f){var l=a+"/get_token";try{(0,n.default)(l,{method:"POST",body:JSON.stringify({key:t,secret:r}),headers:{"Content-Type":"application/json;charset=utf-8"},timeout:3e4}).then(function(t){delete s._.unfulfilledPromises[c],t.json().then(function(r){var n=[];if(r){if(t.ok?"string"==typeof r.errorType&&r.errorType.length>0?r.errorMessage?n.push(r.errorMessage):n.push(u):"string"==typeof r.token&&0!==r.token.trim().length||n.push(u):403===t.status?(n.push("Forbidden."),r.message&&n.push(r.message)):n.push(u),0===n.length){var i=r.token.trim();return void e(i)}}else n.push(u);f(new o.default(n.join(" ")))}).catch(function(e){f(i.default.transformError(e))})}).catch(function(e){delete s._.unfulfilledPromises[c],f(i.default.transformError(e))})}catch(e){delete s._.unfulfilledPromises[c],f(i.default.transformError(e))}});return s._.unfulfilledPromises[c]=f,f}s._={unfulfilledPromises:{}},t.default={getApiAccessToken:s}},function(e,t,r){"use strict";(function(e){var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(e){function t(){this.fetch=!1}return t.prototype=e,new t}("undefined"!=typeof self?self:void 0);(function(e){!function(e){if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],n=function(e){return e&&DataView.prototype.isPrototypeOf(e)},o=ArrayBuffer.isView||function(e){return e&&r.indexOf(Object.prototype.toString.call(e))>-1};f.prototype.append=function(e,t){e=u(e),t=s(t);var r=this.map[e];this.map[e]=r?r+","+t:t},f.prototype.delete=function(e){delete this.map[u(e)]},f.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},f.prototype.set=function(e,t){this.map[u(e)]=s(t)},f.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},f.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),c(e)},f.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),c(e)},f.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),c(e)},t.iterable&&(f.prototype[Symbol.iterator]=f.prototype.entries);var i=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},_.call(y.prototype),_.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},g.error=function(){var e=new g(null,{status:0,statusText:""});return e.type="error",e};var a=[301,302,303,307,308];g.redirect=function(e,t){if(-1===a.indexOf(t))throw new RangeError("Invalid status code");return new g(null,{status:t,headers:{location:e}})},e.Headers=f,e.Request=y,e.Response=g,e.fetch=function(e,r){return new Promise(function(n,o){var i=new y(e,r),a=new XMLHttpRequest;a.onload=function(){var e={status:a.status,statusText:a.statusText,headers:function(e){var t=new f;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}}),t}(a.getAllResponseHeaders()||"")};e.url="responseURL"in a?a.responseURL:e.headers.get("X-Request-URL");var t="response"in a?a.response:a.responseText;n(new g(t,e))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.open(i.method,i.url,!0),"include"===i.credentials?a.withCredentials=!0:"omit"===i.credentials&&(a.withCredentials=!1),"responseType"in a&&t.blob&&(a.responseType="blob"),i.headers.forEach(function(e,t){a.setRequestHeader(t,e)}),a.send(void 0===i._bodyInit?null:i._bodyInit)})},e.fetch.polyfill=!0}function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function s(e){return"string"!=typeof e&&(e=String(e)),e}function c(e){var r={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t.iterable&&(r[Symbol.iterator]=function(){return r}),r}function f(e){this.map={},e instanceof f?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function l(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function d(e){var t=new FileReader,r=p(t);return t.readAsArrayBuffer(e),r}function h(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function _(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&n(e))this._bodyArrayBuffer=h(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!o(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=h(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?l(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(d)}),this.text=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,r=p(t);return t.readAsText(e),r}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(v)}),this.json=function(){return this.text().then(JSON.parse)},this}function y(e,t){var r=(t=t||{}).body;if(e instanceof y){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=function(e){var t=e.toUpperCase();return i.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function v(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}}),t}function g(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}}(void 0!==e?e:this)}).call(r,void 0);var n=r.fetch;n.Response=r.Response,n.Request=r.Request,n.Headers=r.Headers;"object"===t(e)&&e.exports&&(e.exports=n)}).call(this,r(8)(e))},function(e,t,r){"use strict";var n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t||[])).next())})},i=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r};Object.defineProperty(t,"__esModule",{value:!0});var u=r(10),s=r(10);t.ClientError=s.ClientError,r(30);var c=function(){function e(e,t){this.url=e,this.options=t||{}}return e.prototype.rawRequest=function(e,t){return o(this,void 0,void 0,function(){var r,o,s,c,f,p,d,h,_;return i(this,function(i){switch(i.label){case 0:return r=this.options,o=r.headers,s=a(r,["headers"]),c=JSON.stringify({query:e,variables:t||void 0}),[4,fetch(this.url,n({method:"POST",headers:Object.assign({"Content-Type":"application/json"},o),body:c},s))];case 1:return[4,l(f=i.sent())];case 2:if(p=i.sent(),f.ok&&!p.errors&&p.data)return d=f.headers,h=f.status,[2,n({},p,{headers:d,status:h})];throw _="string"==typeof p?{error:p}:p,new u.ClientError(n({},_,{status:f.status,headers:f.headers}),{query:e,variables:t})}})})},e.prototype.request=function(e,t){return o(this,void 0,void 0,function(){var r,o,s,c,f,p,d;return i(this,function(i){switch(i.label){case 0:return r=this.options,o=r.headers,s=a(r,["headers"]),c=JSON.stringify({query:e,variables:t||void 0}),[4,fetch(this.url,n({method:"POST",headers:Object.assign({"Content-Type":"application/json"},o),body:c},s))];case 1:return[4,l(f=i.sent())];case 2:if(p=i.sent(),f.ok&&!p.errors&&p.data)return[2,p.data];throw d="string"==typeof p?{error:p}:p,new u.ClientError(n({},d,{status:f.status}),{query:e,variables:t})}})})},e.prototype.setHeaders=function(e){return this.options.headers=e,this},e.prototype.setHeader=function(e,t){var r,n=this.options.headers;return n?n[e]=t:this.options.headers=((r={})[e]=t,r),this},e}();function f(e,t,r){return o(this,void 0,void 0,function(){return i(this,function(n){return[2,new c(e).request(t,r)]})})}function l(e){return o(this,void 0,void 0,function(){var t;return i(this,function(r){return(t=e.headers.get("Content-Type"))&&t.startsWith("application/json")?[2,e.json()]:[2,e.text()]})})}t.GraphQLClient=c,t.rawRequest=function(e,t,r){return o(this,void 0,void 0,function(){return i(this,function(n){return[2,new c(e).rawRequest(t,r)]})})},t.request=f,t.default=f},function(e,t,r){"use strict";!function(e){if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],n=function(e){return e&&DataView.prototype.isPrototypeOf(e)},o=ArrayBuffer.isView||function(e){return e&&r.indexOf(Object.prototype.toString.call(e))>-1};f.prototype.append=function(e,t){e=u(e),t=s(t);var r=this.map[e];this.map[e]=r?r+","+t:t},f.prototype.delete=function(e){delete this.map[u(e)]},f.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},f.prototype.set=function(e,t){this.map[u(e)]=s(t)},f.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},f.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),c(e)},f.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),c(e)},f.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),c(e)},t.iterable&&(f.prototype[Symbol.iterator]=f.prototype.entries);var i=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},_.call(y.prototype),_.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},g.error=function(){var e=new g(null,{status:0,statusText:""});return e.type="error",e};var a=[301,302,303,307,308];g.redirect=function(e,t){if(-1===a.indexOf(t))throw new RangeError("Invalid status code");return new g(null,{status:t,headers:{location:e}})},e.Headers=f,e.Request=y,e.Response=g,e.fetch=function(e,r){return new Promise(function(n,o){var i=new y(e,r),a=new XMLHttpRequest;a.onload=function(){var e={status:a.status,statusText:a.statusText,headers:function(e){var t=new f;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}}),t}(a.getAllResponseHeaders()||"")};e.url="responseURL"in a?a.responseURL:e.headers.get("X-Request-URL");var t="response"in a?a.response:a.responseText;n(new g(t,e))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.open(i.method,i.url,!0),"include"===i.credentials?a.withCredentials=!0:"omit"===i.credentials&&(a.withCredentials=!1),"responseType"in a&&t.blob&&(a.responseType="blob"),i.headers.forEach(function(e,t){a.setRequestHeader(t,e)}),a.send(void 0===i._bodyInit?null:i._bodyInit)})},e.fetch.polyfill=!0}function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function s(e){return"string"!=typeof e&&(e=String(e)),e}function c(e){var r={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t.iterable&&(r[Symbol.iterator]=function(){return r}),r}function f(e){this.map={},e instanceof f?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function l(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function d(e){var t=new FileReader,r=p(t);return t.readAsArrayBuffer(e),r}function h(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function _(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&n(e))this._bodyArrayBuffer=h(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!o(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=h(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?l(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(d)}),this.text=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,r=p(t);return t.readAsText(e),r}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(v)}),this.json=function(){return this.text().then(JSON.parse)},this}function y(e,t){var r=(t=t||{}).body;if(e instanceof y){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=function(e){var t=e.toUpperCase();return i.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function v(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}}),t}function g(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:void 0)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(r(32));var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._={apiAccessTokenCache:t,internalCache:{}}}return n(e,[{key:"get",value:function(e,t,r,n){var i=this,a=t+":"+r;if(!0!==n&&a in this._.internalCache){var u=this._.internalCache[a];return Promise.resolve(u)}return this._.apiAccessTokenCache.get(e,t,r).then(function(n){return o.default.getUser(e,n).then(function(e){return i._.internalCache[a]=e,e}).catch(function(n){return i._.apiAccessTokenCache.get(e,t,r,!0).then(function(t){return o.default.getUser(e,t).then(function(e){return i._.internalCache[a]=e,e})})})})}}]),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUser=o;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0));function o(e,t){var r=t;if(r in o._.unfulfilledPromises)return o._.unfulfilledPromises[r];var i=new Promise(function(i,a){try{var u=n.default.createClient(e,t);u.request("\n        query {\n          user {\n            cursor\n            xcoobee_id\n            pgp_public_key\n          }\n        }\n      ").then(function(e){delete o._.unfulfilledPromises[r];var t=e.user;i(t)}).catch(function(e){delete o._.unfulfilledPromises[r],a(n.default.transformError(e))})}catch(e){delete o._.unfulfilledPromises[r],a(n.default.transformError(e))}});return o._.unfulfilledPromises[r]=i,i}o._={unfulfilledPromises:{}},t.default={getUser:o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=d(r(0)),i=d(r(34)),a=d(r(11)),u=d(r(6)),s=d(r(1)),c=d(r(2)),f=d(r(12)),l=d(r(4)),p=d(r(5));function d(e){return e&&e.__esModule?e:{default:e}}function h(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(o,i){try{var a=t[o](i),u=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}var _=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._={apiAccessTokenCache:r,config:t||null,usersCache:n}}return n(e,[{key:"_assertValidState",value:function(){if(!this._.config)throw TypeError("Illegal State: Default config has not been set yet.")}},{key:"listBees",value:function(){var e=h(regeneratorRuntime.mark(function e(t){var r,n,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,u=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),r=function(){var e=h(regeneratorRuntime.mark(function e(t,r){var n,o,a,s,c,f,l,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.apiKey,o=t.apiSecret,a=t.apiUrlRoot,s=r.after,c=r.limit,f=r.searchText,e.next=4,u._.apiAccessTokenCache.get(a,n,o);case 4:return l=e.sent,e.next=7,i.default.bees(a,l,f,s,c);case 7:return p=e.sent,e.abrupt("return",p);case 9:case"end":return e.stop()}},e,u)}));return function(t,r){return e.apply(this,arguments)}}(),n=l.default.resolveApiCfg(c,this._.config),o={after:a,limit:s,searchText:t},e.abrupt("return",l.default.startPaging(r,n,o));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"takeOff",value:function(){var e=h(regeneratorRuntime.mark(function e(t,r,n){var i,u,s,f,d,h,_,y,v,g,m=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(h in this._assertValidState(),i=l.default.resolveApiCfg(m,this._.config),u=i.apiKey,s=i.apiSecret,f=i.apiUrlRoot,d={filenames:r.process.fileNames,user_reference:r.process.userReference||null},n&&(d.subscriptions=n),Array.isArray(r.process.destinations)&&r.process.destinations.length>0&&(d.destinations=r.process.destinations.map(function(e){return o.default.appearsToBeAnEmailAddress(e)?{email:e}:{xcoobee_id:e}})),d.bees=[],t)"transfer"!==h&&(_=t[h],d.bees.push({bee_name:h,params:JSON.stringify(_)}));return e.prev=8,e.next=11,this._.apiAccessTokenCache.get(f,u,s);case 11:return y=e.sent,e.next=14,a.default.addDirective(f,y,d);case 14:return v=e.sent,g=new p.default({ref_id:v}),e.abrupt("return",g);case 19:throw e.prev=19,e.t0=e.catch(8),new c.default(400,e.t0);case 22:case"end":return e.stop()}},e,this,[[8,19]])}));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"uploadFiles",value:function(){var e=h(regeneratorRuntime.mark(function e(t,r){var n,o,i,a,d,h,_,y,v,g,m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertValidState(),(n=r||u.default.OUTBOX)===u.default.OUTBOX){e.next=4;break}throw new s.default('The "intent" argument must be one of: null, undefined, or "'+u.default.OUTBOX+'".');case 4:return o=l.default.resolveApiCfg(m,this._.config),i=o.apiKey,a=o.apiSecret,d=o.apiUrlRoot,e.prev=6,e.next=9,this._.apiAccessTokenCache.get(d,i,a);case 9:return h=e.sent,e.next=12,this._.usersCache.get(d,i,a);case 12:return _=e.sent,y=_.cursor,e.next=16,f.default.upload(d,h,y,n,t);case 16:return v=e.sent,g=new p.default(v),e.abrupt("return",g);case 21:throw e.prev=21,e.t0=e.catch(6),new c.default(400,e.t0);case 24:case"end":return e.stop()}},e,this,[[6,21]])}));return function(t,r){return e.apply(this,arguments)}}()},{key:"config",set:function(e){this._.config=e}}]),e}();t.default=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bees=o;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0));function o(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return n.default.createClient(e,t).request("\n    query getBees($searchText: String, $after: String, $first: Int) {\n      bees(search: $searchText, after: $after, first: $first) {\n        data {\n          bee_icon\n          bee_system_name\n          category\n          cursor\n          date_c,\n          description\n          input_extensions\n          input_file_types\n          is_file_reader\n          label\n          max_filesize\n          output_extensions\n          output_file_types\n          owner_cursor\n          owner_xcoobee_id\n        }\n        page_info {\n          end_cursor\n          has_next_page\n        }\n      }\n    }\n  ",{after:o,first:i,searchText:r}).then(function(e){return e.bees}).catch(function(e){throw n.default.transformError(e)})}t.default={bees:o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){var e=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(o,i){try{var a=t[o](i),u=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}(regeneratorRuntime.mark(function e(t,r,o,a,u){var s,c,f,l,p,d=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s=[a],u&&s.push(u),c=regeneratorRuntime.mark(function e(n,a){var u,c,f,l,p,h,_,y,v,g;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:u=null,c=void 0,f=s[n];case 3:return e.next=5,i.default.outbox_endpoints(t,r,o,u);case 5:if(l=e.sent,p=l.data,h=l.page_info,1!==(_=p.filter(function(e){return e.name===f})).length){e.next=11;break}return e.abrupt("return",{v:_[0]});case 11:v=(y=h||{}).end_cursor,g=y.has_next_page,c=g&&v,u=v;case 14:if(c){e.next=3;break}case 15:case"end":return e.stop()}},e,d)}),f=0,l=s.length;case 4:if(!(f<l)){e.next=12;break}return e.delegateYield(c(f,l),"t0",6);case 6:if("object"!==(void 0===(p=e.t0)?"undefined":n(p))){e.next=9;break}return e.abrupt("return",p.v);case 9:++f,e.next=4;break;case 12:throw new XcooBeeError("Unable to find an endpoint named "+a+" or the fallback end point.");case 13:case"end":return e.stop()}},e,this)}));return function(t,r,n,o,i){return e.apply(this,arguments)}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(r(36));t.default={findEndPoint:o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.outbox_endpoints=o;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0));function o(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return n.default.createClient(e,t).request("\n    query getOutboxEndpoints($userCursor: String!) {\n      outbox_endpoints(user_cursor: $userCursor) {\n        data {\n          cursor\n          date_c\n          name\n        }\n        page_info {\n          end_cursor\n          has_next_page\n        }\n      }\n    }\n  ",{after:o,first:i,userCursor:r}).then(function(e){return e.outbox_endpoints}).catch(function(e){throw n.default.transformError(e)})}t.default={outbox_endpoints:o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.upload_file=s;var n=u(r(3)),o=u(r(38)),i=u(r(1)),a=u(r(0));function u(e){return e&&e.__esModule?e:{default:e}}function s(e,t){var r=t.upload_url,u=new o.default;return u.append("key",t.key),u.append("acl","private"),u.append("X-Amz-Algorithm","AWS4-HMAC-SHA256"),u.append("X-Amz-Credential",t.credential),u.append("X-Amz-Date",t.date),u.append("X-Amz-meta-identifier",t.identifier),u.append("Policy",t.policy),u.append("X-Amz-Signature",t.signature),e instanceof File?u.append("file",e):u.append("file",n.default.createReadStream(e)),new Promise(function(n,o){u.submit(r,function(r,o){if(r)throw a.default.transformError(r);if(o.statusCode>=300){var u=void 0;throw u=e instanceof File?e.name:e,new i.default("Failed to upload file at: "+u+" using policy: "+JSON.stringify(t))}n(o)})})}t.default={upload_file:s}},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports="object"==("undefined"==typeof self?"undefined":n(self))?self.FormData:window.FormData},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.upload_policy=s;var n=u(r(3)),o=r(0),i=u(o),a=u(r(6));function u(e){return e&&e.__esModule?e:{default:e}}function s(e,t,r,u,s){if(!a.default.values.includes(r))throw TypeError("`intent` must be one of "+a.default.values.join(", ")+".");if(!(0,o.appearsToBeACursor)(u))throw TypeError("`endPointCursor` is required.");if(!Array.isArray(s))throw TypeError("`files` must be an array.");var c=["query uploadPolicy {"];return s.forEach(function(e,t){var o=void 0;o=e instanceof File?e.name:n.default.basename(e),c.push("  policy"+t+': upload_policy(filePath: "'+o+'", intent: '+r+', identifier: "'+u+'") {'),c.push("    credential"),c.push("    date"),c.push("    identifier"),c.push("    key"),c.push("    policy"),c.push("    signature"),c.push("    upload_url"),c.push("  }")}),c.push("}"),c=c.join("\n"),i.default.createClient(e,t).request(c).then(function(e){for(var t=[],r=0,n=s.length;r<n;++r){var o=null,i="policy"+r;i in e&&(o=e[i]),t.push(o)}return t}).catch(function(e){throw i.default.transformError(e)})}t.default={upload_policy:s}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=u(r(2)),a=u(r(7));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e,r,n,o){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{apiCfg:n,code:200,currentPage:r,error:null,fetcher:e,hasNextPage:r.page_info.has_next_page,params:o,result:r}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"getNextPage",value:function(){var e=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(o,i){try{var a=t[o](i),u=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}(regeneratorRuntime.mark(function e(){var r,o,a,u,s,c,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasNextPage()){e.next=13;break}return r=this._,o=r.apiCfg,a=r.currentPage,u=r.fetcher,s=r.params,c=n({},s,{after:a.page_info.end_cursor}),e.prev=3,e.next=6,this._.fetcher(o,c);case 6:return f=e.sent,e.abrupt("return",new t(u,f,o,s));case 10:return e.prev=10,e.t0=e.catch(3),e.abrupt("return",new i.default(400,e.t0));case 13:return e.abrupt("return",null);case 14:case"end":return e.stop()}},e,this,[[3,10]])}));return function(){return e.apply(this,arguments)}}()}]),t}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=_(r(3)),i=_(r(13)),a=_(r(42)),u=_(r(14)),s=_(r(11)),c=_(r(6)),f=_(r(1)),l=_(r(2)),p=_(r(12)),d=_(r(4)),h=_(r(5));function _(e){return e&&e.__esModule?e:{default:e}}function y(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(o,i){try{var a=t[o](i),u=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}var v=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._={apiAccessTokenCache:r,config:t||null,usersCache:n}}return n(e,[{key:"_assertValidState",value:function(){if(!this._.config)throw TypeError("Illegal State: Default config has not been set yet.")}},{key:"confirmConsentChange",value:function(){var e=y(regeneratorRuntime.mark(function e(t){var r,n,o,i,u,s,c,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),r=d.default.resolveApiCfg(f,this._.config),n=r.apiKey,o=r.apiSecret,i=r.apiUrlRoot,e.prev=3,e.next=6,this._.apiAccessTokenCache.get(i,n,o);case 6:return u=e.sent,e.next=9,a.default.confirmConsentChange(i,u,t);case 9:return s=e.sent,c=new h.default(s),e.abrupt("return",c);case 14:throw e.prev=14,e.t0=e.catch(3),new l.default(400,e.t0);case 17:case"end":return e.stop()}},e,this,[[3,14]])}));return function(t){return e.apply(this,arguments)}}()},{key:"confirmDataDelete",value:function(){var e=y(regeneratorRuntime.mark(function e(t){var r,n,o,i,u,s,c,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),r=d.default.resolveApiCfg(f,this._.config),n=r.apiKey,o=r.apiSecret,i=r.apiUrlRoot,e.prev=3,e.next=6,this._.apiAccessTokenCache.get(i,n,o);case 6:return u=e.sent,e.next=9,a.default.confirmDataDelete(i,u,t);case 9:return s=e.sent,c=new h.default(s),e.abrupt("return",c);case 14:throw e.prev=14,e.t0=e.catch(3),new l.default(400,e.t0);case 17:case"end":return e.stop()}},e,this,[[3,14]])}));return function(t){return e.apply(this,arguments)}}()},{key:"getCampaignInfo",value:function(){var e=y(regeneratorRuntime.mark(function e(t){var r,n,o,a,u,s,c,f,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),r=d.default.resolveCampaignId(t,p,this._.config),n=d.default.resolveApiCfg(p,this._.config),o=n.apiKey,a=n.apiSecret,u=n.apiUrlRoot,e.prev=4,e.next=7,this._.apiAccessTokenCache.get(u,o,a);case 7:return s=e.sent,e.next=10,i.default.getCampaignInfo(u,s,r);case 10:return c=e.sent,f=new h.default(c),e.abrupt("return",f);case 15:throw e.prev=15,e.t0=e.catch(4),new l.default(400,e.t0);case 18:case"end":return e.stop()}},e,this,[[4,15]])}));return function(t){return e.apply(this,arguments)}}()},{key:"getConsentData",value:function(){var e=y(regeneratorRuntime.mark(function e(t){var r,n,o,i,u,s,c,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),r=d.default.resolveApiCfg(f,this._.config),n=r.apiKey,o=r.apiSecret,i=r.apiUrlRoot,e.prev=3,e.next=6,this._.apiAccessTokenCache.get(i,n,o);case 6:return u=e.sent,e.next=9,a.default.getConsentData(i,u,t);case 9:return s=e.sent,c=new h.default(s),e.abrupt("return",c);case 14:throw e.prev=14,e.t0=e.catch(3),new l.default(400,e.t0);case 17:case"end":return e.stop()}},e,this,[[3,14]])}));return function(t){return e.apply(this,arguments)}}()},{key:"getCookieConsent",value:function(){var e=y(regeneratorRuntime.mark(function e(t,r){var n,o,i,u,s,c,f,p,_,y,v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),n=d.default.resolveCampaignId(r,v,this._.config),o=d.default.resolveApiCfg(v,this._.config),i=o.apiKey,u=o.apiSecret,s=o.apiUrlRoot,e.prev=4,e.next=7,this._.apiAccessTokenCache.get(s,i,u);case 7:return c=e.sent,e.next=10,this._.usersCache.get(s,i,u);case 10:return f=e.sent,p=f.cursor,e.next=14,a.default.getCookieConsent(s,c,t,p,n);case 14:return _=e.sent,y=new h.default(_),e.abrupt("return",y);case 19:throw e.prev=19,e.t0=e.catch(4),new l.default(400,e.t0);case 22:case"end":return e.stop()}},e,this,[[4,19]])}));return function(t,r){return e.apply(this,arguments)}}()},{key:"listCampaigns",value:function(){var e=y(regeneratorRuntime.mark(function e(){var t,r,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),t=function(){var e=y(regeneratorRuntime.mark(function e(t,r){var n,o,u,s,c,f,l,p,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.apiKey,o=t.apiSecret,u=t.apiUrlRoot,s=r.after,c=r.limit,e.next=4,a._.apiAccessTokenCache.get(u,n,o);case 4:return f=e.sent,e.next=7,a._.usersCache.get(u,n,o);case 7:return l=e.sent,p=l.cursor,e.next=11,i.default.getCampaigns(u,f,p,s,c);case 11:return d=e.sent,e.abrupt("return",d);case 13:case"end":return e.stop()}},e,a)}));return function(t,r){return e.apply(this,arguments)}}(),r=d.default.resolveApiCfg(s,this._.config),n={after:o,limit:u},e.abrupt("return",d.default.startPaging(t,r,n));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"listConsents",value:function(){var e=y(regeneratorRuntime.mark(function e(t){var r,n,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,u=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),r=function(){var e=y(regeneratorRuntime.mark(function e(t,r){var n,o,i,s,c,f,l,p,d,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.apiKey,o=t.apiSecret,i=t.apiUrlRoot,s=r.after,c=r.limit,f=r.status,e.next=4,u._.apiAccessTokenCache.get(i,n,o);case 4:return l=e.sent,e.next=7,u._.usersCache.get(i,n,o);case 7:return p=e.sent,d=p.cursor,e.next=11,a.default.listConsents(i,l,d,f,s,c);case 11:return h=e.sent,e.abrupt("return",h);case 13:case"end":return e.stop()}},e,u)}));return function(t,r){return e.apply(this,arguments)}}(),n=d.default.resolveApiCfg(c,this._.config),o={after:i,limit:s,status:t},e.abrupt("return",d.default.startPaging(r,n,o));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"requestConsent",value:function(){var e=y(regeneratorRuntime.mark(function e(t,r,n){var o,i,u,s,c,f,p,_,y=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),o=d.default.resolveCampaignId(n,y,this._.config),i=d.default.resolveApiCfg(y,this._.config),u=i.apiKey,s=i.apiSecret,c=i.apiUrlRoot,e.prev=4,e.next=7,this._.apiAccessTokenCache.get(c,u,s);case 7:return f=e.sent,e.next=10,a.default.requestConsent(c,f,t,o,r);case 10:return p=e.sent,_=new h.default(p),e.abrupt("return",_);case 15:throw e.prev=15,e.t0=e.catch(4),new l.default(400,e.t0);case 18:case"end":return e.stop()}},e,this,[[4,15]])}));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"setUserDataResponse",value:function(){var e=y(regeneratorRuntime.mark(function e(t,r,n,i){var _,y,v,g,m,b,E,w,C,T,O,A,I,R,S,x,P,N,k,M,D=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),_=d.default.resolveApiCfg(D,this._.config),y=_.apiKey,v=_.apiSecret,g=_.apiUrlRoot,m=[],b=[],E=void 0,e.prev=6,e.next=9,this._.apiAccessTokenCache.get(g,y,v);case 9:return w=e.sent,e.next=12,this._.usersCache.get(g,y,v);case 12:return C=e.sent,T=C.cursor,O=null,e.next=17,u.default.sendUserMessage(g,w,t,T,r,O);case 17:if(b.push("successfully sent message"),A={progress:b,ref_id:null},!(n&&Array.isArray(i)&&i.length>0)){e.next=37;break}return I=c.default.OUTBOX,e.next=23,p.default.upload(g,w,T,I,i);case 23:if(R=e.sent,S=[],R.forEach(function(e){var t=e.error,r=e.file;e.success?(S.push(r),b.push("successfully uploaded "+r)):(m.push("Failed to upload file: "+r+". Error: "+t+"."),b.push("failed upload on "+r))}),!(S.length>0)){e.next=37;break}return e.next=29,a.default.resolveXcoobeeId(g,w,r);case 29:return x=e.sent,P=S.map(function(e){return o.default.basename(e)}),N={destinations:[{xcoobee_id:x}],filenames:P,user_reference:n},e.next=34,s.default.addDirective(g,w,N);case 34:k=e.sent,b.push("successfully sent successfully uploaded files to destination"),A.ref_id=k;case 37:E=new h.default(A),e.next=43;break;case 40:e.prev=40,e.t0=e.catch(6),m.push(e.t0.message);case 43:if(!(m.length>0)){e.next=46;break}throw M=m.join(" "),new l.default(400,new f.default(M));case 46:return e.abrupt("return",E);case 47:case"end":return e.stop()}},e,this,[[6,40]])}));return function(t,r,n,o){return e.apply(this,arguments)}}()},{key:"config",set:function(e){this._.config=e}}]),e}();t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.confirmConsentChange=f,t.confirmDataDelete=l,t.getCookieConsent=p,t.getConsentData=d,t.listConsents=h,t.requestConsent=_,t.resolveXcoobeeId=y;var n=s(r(1)),o=s(r(0)),i=s(r(43)),a=s(r(44)),u=s(r(45));function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t,r){return o.default.createClient(e,t).request("\n    mutation confirmConsentChange($consentCursor: String!) {\n      confirm_consent_change(consent_cursor: $consentCursor) {\n        consent_cursor\n      }\n    }\n  ",{consentCursor:r}).then(function(e){return{confirmed:e.confirm_consent_change.consent_cursor===r}}).catch(function(e){throw o.default.transformError(e)})}function l(e,t,r){return o.default.createClient(e,t).request("\n    mutation confirmDataDelete($consentCursor: String!) {\n      confirm_consent_deletion(consent_cursor: $consentCursor) {\n        consent_cursor\n      }\n    }\n  ",{consentCursor:r}).then(function(e){return{confirmed:e.confirm_consent_deletion.consent_cursor===r}}).catch(function(e){throw o.default.transformError(e)})}function p(e,t,r,s,f){o.default.assertAppearsToBeACampaignId(f);return o.default.createClient(e,t).request("\n    query getCookieConsent($userCursor: String!, $campaignId: String!, $status: ConsentStatus) {\n      consents(campaign_owner_cursor: $userCursor, campaign_cursor: $campaignId, status: $status) {\n        data {\n          consent_type,\n          request_data_types,\n          user_xcoobee_id,\n        }\n        page_info {\n          end_cursor\n          has_next_page\n        }\n      }\n    }\n  ",{campaignId:f,status:a.default.ACTIVE,userCursor:s}).then(function(e){var t,o=e.consents,a=o.data;if(o.page_info.has_next_page)throw(0,n.default)("Too many active consents to be able to determine cookie consents. Please notify XcooBee of this issue.");var s=(c(t={},i.default.ADVERTISING_COOKIE,!1),c(t,i.default.APPLICATION_COOKIE,!1),c(t,i.default.STATISTICS_COOKIE,!1),c(t,i.default.USAGE_COOKIE,!1),t);return a.forEach(function(e){e.user_xcoobee_id===r&&[u.default.WEB_APPLICATION_TRACKING,u.default.WEBSITE_TRACKING].includes(e.consent_type)&&(e.request_data_types.includes(i.default.ADVERTISING_COOKIE)&&(s[i.default.ADVERTISING_COOKIE]=!0),e.request_data_types.includes(i.default.APPLICATION_COOKIE)&&(s[i.default.APPLICATION_COOKIE]=!0),e.request_data_types.includes(i.default.STATISTICS_COOKIE)&&(s[i.default.STATISTICS_COOKIE]=!0),e.request_data_types.includes(i.default.USAGE_COOKIE)&&(s[i.default.USAGE_COOKIE]=!0))}),{cookie_consents:s}}).catch(function(e){throw o.default.transformError(e)})}function d(e,t,r){return o.default.createClient(e,t).request("\n    query getConsentData($consentCursor: String!) {\n      consent(consent_cursor: $consentCursor) {\n        consent_description\n        consent_details {\n          datatype\n        }\n        consent_name\n        consent_status\n        consent_type\n        date_c\n        date_e\n        request_data_types\n        request_owner\n        required_data_types\n        user_cursor\n        user_display_name\n        user_xcoobee_id\n      }\n    }\n  ",{consentCursor:r}).then(function(e){return{consent:e.consent}}).catch(function(e){throw o.default.transformError(e)})}function h(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if("string"==typeof n&&!a.default.values.includes(n))throw TypeError("Invalid consent status: "+n+".  Must be one of "+a.default.values.join(", ")+".");return o.default.createClient(e,t).request("\n    query listConsents($userCursor: String!, $status: ConsentStatus, $after: String, $first: Int) {\n      consents(campaign_owner_cursor: $userCursor, status : $status, after: $after, first: $first) {\n        data {\n          consent_cursor,\n          consent_status,\n          date_c,\n          date_e,\n          user_xcoobee_id,\n        }\n        page_info {\n          end_cursor\n          has_next_page\n        }\n      }\n    }\n  ",{after:i,first:u,status:n,userCursor:r}).then(function(e){return e.consents}).catch(function(e){throw o.default.transformError(e)})}function _(e,t,r,n,i){return o.default.createClient(e,t).request("\n    mutation requestConsent($config: AdditionalRequestConfig) {\n      send_consent_request(config: $config) {\n        ref_id\n      }\n    }\n  ",{config:{campaign_cursor:n,reference:i,xcoobee_id:r}}).then(function(e){return{ref_id:e.send_consent_request.ref_id}}).catch(function(e){throw o.default.transformError(e)})}function y(e,t,r){return o.default.createClient(e,t).request("\n    query resolveXcoobeeId($consentCursor: String!) {\n      consent(consent_cursor: $consentCursor) {\n        user_xcoobee_id\n      }\n    }\n  ",{consentCursor:r}).then(function(e){return e.consent.user_xcoobee_id}).catch(function(e){throw o.default.transformError(e)})}t.default={confirmConsentChange:f,confirmDataDelete:l,getCookieConsent:p,getConsentData:d,listConsents:h,resolveXcoobeeId:y,requestConsent:_}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.ADVERTISING_COOKIE="advertising_cookie",o=t.ALTERNATE_EMAIL="alternate_email",i=t.ALTERNATE_PHONE="alternate_phone",a=t.APPLICATION_COOKIE="application_cookie",u=t.BANK_ACCOUNTS="bank_accounts",s=t.BIOMETRIC_DATA="biometric_data",c=t.BROWSER_DETAILS="browser_details",f=t.CITY="city",l=t.COLLEAGUES="colleagues",p=t.COUNTRY="country",d=t.CRIMINAL_CONVICTION="criminal_conviction",h=t.CUSTOM="custom",_=t.DATE_OF_BIRTH="date_of_birth",y=t.DENTAL_RECORD="dental_record",v=t.DEVICE_IDENTIFIERS="device_identifiers",g=t.EMAIL="email",m=t.EMERGENCY_MEDICAL_RECORD="emergency_medical_record",b=t.ETHNICITY_RACE="ethnicity_race",E=t.FAMILY_MEMBERS="family_members",w=t.FIRST_NAME="first_name",C=t.FRIENDS="friends",T=t.GENETIC_DATA="genetic_data",O=t.GOVERNMENT_DOCUMENT_REFERENCES="government_document_references",A=t.GOVERNMENT_ID="government_id",I=t.HEALTH_METRICS="health_metrics",R=t.HEALTH_RECORD="health_record",S=t.IMAGE="image",x=t.INTERNET_ACCESS_RECORD="internet_access_record",P=t.IP_ADDRESS="ip_address",N=t.LAST_NAME="last_name",k=t.LOCATION_DATA="location_data",M=t.MEMBERSHIP="membership",D=t.MENTAL_HEALTH_RECORD="mental_health_record",j=t.METER_READING="meter_reading",U=t.MIDDLE_NAME="middle_name",L=t.NAME_PREFIX="name_prefix",B=t.NAME_SUFFIX="name_suffix",q=t.OTHER1="other1",G=t.OTHER2="other2",F=t.OTHER3="other3",H=t.OTHER4="other4",$=t.OTHER5="other5",V=t.OTHER6="other6",K=t.OTHER7="other7",Y=t.OTHER8="other8",X=t.OTHER9="other9",z=t.PARTY_AFFILIATION="party_affiliation",W=t.PHONE="phone",J=t.PHYSICAL_HEALTH_RECORD="physical_health_record",Q=t.RELIGION="religion",Z=t.SEXUAL_ORIENTATION="sexual_orientation",ee=t.SOCIAL_POSTS="social_posts",te=t.STATE="state",re=t.STATISTICS_COOKIE="statistics_cookie",ne=t.STREET1="street1",oe=t.STREET2="street2",ie=t.TWITTER_HANDLE="twitter_handle",ae=t.USAGE_COOKIE="usage_cookie",ue=t.XCOOBEE_ID="xcoobee_id",se=Object.freeze([n,o,i,a,u,s,c,f,l,p,d,h,_,y,v,g,m,b,E,w,C,T,O,A,I,R,S,x,P,N,k,M,D,j,U,L,B,q,G,F,H,$,V,K,Y,X,z,W,J,Q,Z,ee,te,re,ne,oe,ie,ae,ue]),ce=Object.freeze({ADVERTISING_COOKIE:n,ALTERNATE_EMAIL:o,ALTERNATE_PHONE:i,APPLICATION_COOKIE:a,BANK_ACCOUNTS:u,BIOMETRIC_DATA:s,BROWSER_DETAILS:c,CITY:f,COLLEAGUES:l,COUNTRY:p,CRIMINAL_CONVICTION:d,CUSTOM:h,DATE_OF_BIRTH:_,DENTAL_RECORD:y,DEVICE_IDENTIFIERS:v,EMAIL:g,EMERGENCY_MEDICAL_RECORD:m,ETHNICITY_RACE:b,FAMILY_MEMBERS:E,FIRST_NAME:w,FRIENDS:C,GENETIC_DATA:T,GOVERNMENT_DOCUMENT_REFERENCES:O,GOVERNMENT_ID:A,HEALTH_METRICS:I,HEALTH_RECORD:R,IMAGE:S,INTERNET_ACCESS_RECORD:x,IP_ADDRESS:P,LAST_NAME:N,LOCATION_DATA:k,MEMBERSHIP:M,MENTAL_HEALTH_RECORD:D,METER_READING:j,MIDDLE_NAME:U,NAME_PREFIX:L,NAME_SUFFIX:B,OTHER1:q,OTHER2:G,OTHER3:F,OTHER4:H,OTHER5:$,OTHER6:V,OTHER7:K,OTHER8:Y,OTHER9:X,PARTY_AFFILIATION:z,PHONE:W,PHYSICAL_HEALTH_RECORD:J,RELIGION:Q,SEXUAL_ORIENTATION:Z,SOCIAL_POSTS:ee,STATE:te,STATISTICS_COOKIE:re,STREET1:ne,STREET2:oe,TWITTER_HANDLE:ie,USAGE_COOKIE:ae,XCOOBEE_ID:ue,values:se});t.default=ce},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.ACTIVE="active",o=t.CANCELED="canceled",i=t.EXPIRED="expired",a=t.PENDING="pending",u=t.OFFER="offer",s=t.REJECTED="rejected",c=t.UPDATING="updating",f=Object.freeze([n,o,i,a,u,s,c]),l=Object.freeze({ACTIVE:n,CANCELED:o,EXPIRED:i,PENDING:a,OFFER:u,REJECTED:s,UPDATING:c,values:f});t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.ANONYMIZED_DATA_AGGREGATION="anonymized_data_aggregation",o=t.BILLING="billing",i=t.CARE_DELIVERY="care_delivery",a=t.COMPANY_INFORMATION="company_information",u=t.CONTRACTOR_MANAGEMENT="contractor_management",s=t.CREATE_CUSTOM_PRODUCT="create_custom_product",c=t.CREATE_CUSTOM_SERVICE="create_custom_service",f=t.CREATE_CUSTOM_SERVICE_AND_PRODUCT="create_custom_service_and_product",l=t.DATA_AGGREGATION="data_aggregation",p=t.DELIVER_A_PRODUCT="deliver_a_product",d=t.DELIVER_ITINIARY_CHANGES="deliver_itiniary_changes",h=t.EMERGENCY_REQUEST="emergency_request",_=t.EMERGENCY_SERVICES="emergency_services",y=t.EMPLOYEE_ADMINISTRATION="employee_administration",v=t.EMPLOYEE_MANAGEMENT="employee_management",g=t.FINANCIAL_REPORTS="financial_reports",m=t.GOVERNMENT_SERVICES="government_services",b=t.HEALTH_BILLING="health_billing",E=t.HEALTH_CARE_SERVICES="health_care_services",w=t.IOT_DEVICE_TRACKING="iot_device_tracking",C=t.IT_ADMINISTRATION="it_administration",T=t.LAW_ENFORCEMENT="law_enforcement",O=t.MARKETING="marketing",A=t.MISSING="missing",I=t.MOBILE_DEVICE_TRACKING="mobile_device_tracking",R=t.ORDER_FULLFILLMENT="order_fullfillment",S=t.OTHER="other",x=t.PERFORM_A_SERVICE="perform_a_service",P=t.PERFORM_CONTRACT="perform_contract",N=t.PRESS_RELEASEASES="press_releaseases",k=t.PRIVATE_CONSENT="private_consent",M=t.PRODUCT_ANNOUNCEMENT="product_announcement",D=t.PRODUCT_INFORMATION="product_information",j=t.PROMOTION="promotion",U=t.SHIPPING="shipping",L=t.SUPPLIER_SCREENING="supplier_screening",B=t.SUPPORT="support",q=t.SUPPORT_A_PRODUCT="support_a_product",G=t.SUPPORT_A_SERVICE="support_a_service",F=t.SURVEY="survey",H=t.TRAINING="training",$=t.TRAVEL="travel",V=t.WEB_APPLICATION_TRACKING="web_application_tracking",K=t.WEBSITE_TRACKING="website_tracking",Y=Object.freeze([n,o,i,a,u,s,c,f,l,p,d,h,_,y,v,g,m,b,E,w,C,T,O,A,I,R,S,x,P,N,k,M,D,j,U,L,B,q,G,F,H,$,V,K]),X=Object.freeze({ANONYMIZED_DATA_AGGREGATION:n,BILLING:o,CARE_DELIVERY:i,COMPANY_INFORMATION:a,CONTRACTOR_MANAGEMENT:u,CREATE_CUSTOM_PRODUCT:s,CREATE_CUSTOM_SERVICE:c,CREATE_CUSTOM_SERVICE_AND_PRODUCT:f,DATA_AGGREGATION:l,DELIVER_A_PRODUCT:p,DELIVER_ITINIARY_CHANGES:d,EMERGENCY_REQUEST:h,EMERGENCY_SERVICES:_,EMPLOYEE_ADMINISTRATION:y,EMPLOYEE_MANAGEMENT:v,FINANCIAL_REPORTS:g,GOVERNMENT_SERVICES:m,HEALTH_BILLING:b,HEALTH_CARE_SERVICES:E,IOT_DEVICE_TRACKING:w,IT_ADMINISTRATION:C,LAW_ENFORCEMENT:T,MARKETING:O,MISSING:A,MOBILE_DEVICE_TRACKING:I,ORDER_FULLFILLMENT:R,OTHER:S,PERFORM_A_SERVICE:x,PERFORM_CONTRACT:P,PRESS_RELEASEASES:N,PRIVATE_CONSENT:k,PRODUCT_ANNOUNCEMENT:M,PRODUCT_INFORMATION:D,PROMOTION:j,SHIPPING:U,SUPPLIER_SCREENING:L,SUPPORT:B,SUPPORT_A_PRODUCT:q,SUPPORT_A_SERVICE:G,SURVEY:F,TRAINING:H,TRAVEL:$,WEB_APPLICATION_TRACKING:V,WEBSITE_TRACKING:K,values:Y});t.default=X},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.BREACH="breach",o=t.BROADCAST="broadcast",i=t.CONSENT="consent",a=t.TICKET="ticket",u=Object.freeze([n,o,i,a]),s=Object.freeze({BREACH:n,BROADCAST:o,CONSENT:i,TICKET:a,values:u});t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=s(r(48)),i=s(r(2)),a=s(r(4)),u=s(r(5));function s(e){return e&&e.__esModule?e:{default:e}}function c(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(o,i){try{var a=t[o](i),u=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}var f=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._={apiAccessTokenCache:r,config:t||null,usersCache:n}}return n(e,[{key:"_assertValidState",value:function(){if(!this._.config)throw TypeError("Illegal State: Default config has not been set yet.")}},{key:"deleteInboxItem",value:function(){var e=c(regeneratorRuntime.mark(function e(t){var r,n,s,c,f,l,p,d,h,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),r=a.default.resolveApiCfg(_,this._.config),n=r.apiKey,s=r.apiSecret,c=r.apiUrlRoot,e.prev=3,e.next=6,this._.apiAccessTokenCache.get(c,n,s);case 6:return f=e.sent,e.next=9,this._.usersCache.get(c,n,s);case 9:return l=e.sent,p=l.cursor,e.next=13,o.default.deleteInboxItem(c,f,p,t);case 13:return d=e.sent,h=new u.default(d),e.abrupt("return",h);case 18:throw e.prev=18,e.t0=e.catch(3),new i.default(400,e.t0);case 21:case"end":return e.stop()}},e,this,[[3,18]])}));return function(t){return e.apply(this,arguments)}}()},{key:"getInboxItem",value:function(){var e=c(regeneratorRuntime.mark(function e(t){var r,n,s,c,f,l,p,d,h,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),r=a.default.resolveApiCfg(_,this._.config),n=r.apiKey,s=r.apiSecret,c=r.apiUrlRoot,e.prev=3,e.next=6,this._.apiAccessTokenCache.get(c,n,s);case 6:return f=e.sent,e.next=9,this._.usersCache.get(c,n,s);case 9:return l=e.sent,p=l.cursor,e.next=13,o.default.getInboxItem(c,f,p,t);case 13:return d=e.sent,h=new u.default(d),e.abrupt("return",h);case 18:throw e.prev=18,e.t0=e.catch(3),new i.default(400,e.t0);case 21:case"end":return e.stop()}},e,this,[[3,18]])}));return function(t){return e.apply(this,arguments)}}()},{key:"listInbox",value:function(){var e=c(regeneratorRuntime.mark(function e(){var t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,u=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),t=function(){var e=c(regeneratorRuntime.mark(function e(t,r){var n,i,a,s,c,f,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.apiKey,i=t.apiSecret,a=t.apiUrlRoot,s=r.after,c=r.limit,e.next=4,u._.apiAccessTokenCache.get(a,n,i);case 4:return f=e.sent,e.next=7,o.default.listInbox(a,f,s,c);case 7:return l=e.sent,e.abrupt("return",l);case 9:case"end":return e.stop()}},e,u)}));return function(t,r){return e.apply(this,arguments)}}(),r=a.default.resolveApiCfg(f,this._.config),n={after:i,limit:s},e.abrupt("return",a.default.startPaging(t,r,n));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"config",set:function(e){this._.config=e}}]),e}();t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.deleteInboxItem=i,t.getInboxItem=a,t.listInbox=u;var o=function(e){return e&&e.__esModule?e:{default:e}}(r(0));function i(e,t,r,n){return o.default.createClient(e,t).request("\n    mutation deleteInboxItem($userCursor: String!, $messageId: String!) {\n      remove_inbox_item(user_cursor: $userCursor, filename: $messageId) {\n        trans_id\n      }\n    }\n  ",{userCursor:r,messageId:n}).then(function(e){return{trans_id:(e.remove_inbox_item||{trans_id:null}).trans_id}}).catch(function(e){throw o.default.transformError(e)})}function a(e,t,r,n){return o.default.createClient(e,t).request("\n    query getInboxItem($userCursor: String!, $messageId: String!) {\n      inbox_item(user_cursor: $userCursor, filename: $messageId) {\n        download_link\n        info {\n          date\n          downloaded\n          filename\n          file_size\n          file_tags\n          file_type\n          from\n          from_xcoobee_id\n          original_name\n          sender {\n            from\n            from_xcoobee_id\n            name\n            photo_url\n            validation_score\n          }\n          trans_id\n          trans_name\n          user_ref\n        }\n      }\n    }\n  ",{messageId:n,userCursor:r}).then(function(e){return{inbox_item:e.inbox_item}}).catch(function(e){throw o.default.transformError(e)})}function u(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return o.default.createClient(e,t).request("\n    query listInbox($after: String, $first: Int) {\n      inbox(after: $after, first: $first) {\n        data {\n          date\n          downloaded\n          file_size\n          filename\n          original_name\n          sender {\n            from\n            from_xcoobee_id\n            name\n            validation_score\n          }\n        }\n        page_info {\n          end_cursor\n          has_next_page\n        }\n      }\n    }\n  ",{after:r,first:i}).then(function(e){var t=e.inbox,r=t.data,o=t.page_info;return{data:r=r.map(function(e){return{messageId:e.filename,fileName:e.original_name,fileSize:e.file_size,sender:n({},e.sender),receiptDate:e.date,downloadDate:e.downloaded,expirationDate:e.date}}),page_info:o}}).catch(function(e){throw o.default.transformError(e)})}t.default={deleteInboxItem:i,getInboxItem:a,listInbox:u}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=l(r(13)),i=l(r(50)),a=l(r(51)),u=l(r(1)),s=l(r(2)),c=l(r(4)),f=l(r(5));function l(e){return e&&e.__esModule?e:{default:e}}function p(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(o,i){try{var a=t[o](i),u=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}var d=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._={apiAccessTokenCache:r,config:t||null,usersCache:n}}return n(e,[{key:"_assertValidState",value:function(){if(!this._.config)throw TypeError("Illegal State: Default config has not been set yet.")}},{key:"addEventSubscription",value:function(){var e=p(regeneratorRuntime.mark(function e(t,r){var n,o,i,u,l,p,d,h,_=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),n=c.default.resolveCampaignId(r,_,this._.config),o=c.default.resolveApiCfg(_,this._.config),i=o.apiKey,u=o.apiSecret,l=o.apiUrlRoot,e.prev=4,e.next=7,this._.apiAccessTokenCache.get(l,i,u);case 7:return p=e.sent,e.next=10,a.default.addEventSubscription(l,p,t,n);case 10:return d=e.sent,h=new f.default(d),e.abrupt("return",h);case 15:throw e.prev=15,e.t0=e.catch(4),new s.default(400,e.t0);case 18:case"end":return e.stop()}},e,this,[[4,15]])}));return function(t,r){return e.apply(this,arguments)}}()},{key:"deleteEventSubscription",value:function(){var e=p(regeneratorRuntime.mark(function e(t,r){var n,o,i,u,l,p,d,h,_=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),n=c.default.resolveCampaignId(r,_,this._.config),o=c.default.resolveApiCfg(_,this._.config),i=o.apiKey,u=o.apiSecret,l=o.apiUrlRoot,e.prev=4,e.next=7,this._.apiAccessTokenCache.get(l,i,u);case 7:return p=e.sent,e.next=10,a.default.deleteEventSubscription(l,p,t,n);case 10:return d=e.sent,h=new f.default(d),e.abrupt("return",h);case 15:throw e.prev=15,e.t0=e.catch(4),new s.default(400,e.t0);case 18:case"end":return e.stop()}},e,this,[[4,15]])}));return function(t,r){return e.apply(this,arguments)}}()},{key:"getEvents",value:function(){var e=p(regeneratorRuntime.mark(function e(){var t,r,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),t=function(){var e=p(regeneratorRuntime.mark(function e(t,r){var n,o,u,s,c,f,l,p,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.apiKey,o=t.apiSecret,u=t.apiUrlRoot,s=r.after,c=r.limit,e.next=4,a._.apiAccessTokenCache.get(u,n,o);case 4:return f=e.sent,e.next=7,a._.usersCache.get(u,n,o);case 7:return l=e.sent,p=l.cursor,e.next=11,i.default.getEvents(u,f,p,s,c);case 11:return d=e.sent,e.abrupt("return",d);case 13:case"end":return e.stop()}},e,a)}));return function(t,r){return e.apply(this,arguments)}}(),r=c.default.resolveApiCfg(s,this._.config),n={after:o,limit:u},e.abrupt("return",c.default.startPaging(t,r,n));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"listEventSubscriptions",value:function(){var e=p(regeneratorRuntime.mark(function e(t){var r,n,o,i,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),r=c.default.resolveCampaignId(t,l,this._.config),n=function(){var e=p(regeneratorRuntime.mark(function e(t,r){var n,o,i,u,c,f,l,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.apiKey,o=t.apiSecret,i=t.apiUrlRoot,u=r.after,c=r.limit,f=r.resolvedCampaignId,e.next=4,s._.apiAccessTokenCache.get(i,n,o);case 4:return l=e.sent,e.next=7,a.default.listEventSubscriptions(i,l,f,u,c);case 7:return p=e.sent,e.abrupt("return",p);case 9:case"end":return e.stop()}},e,s)}));return function(t,r){return e.apply(this,arguments)}}(),o=c.default.resolveApiCfg(l,this._.config),i={after:u,limit:f,resolvedCampaignId:r},e.abrupt("return",c.default.startPaging(n,o,i));case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"ping",value:function(){var e=p(regeneratorRuntime.mark(function e(){var t,r,n,i,a,l,p,d,h,_,y,v=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),t=c.default.resolveCampaignId(null,v,this._.config),r=c.default.resolveApiCfg(v,this._.config),n=r.apiKey,i=r.apiSecret,a=r.apiUrlRoot,e.prev=4,e.next=7,this._.apiAccessTokenCache.get(a,n,i);case 7:return l=e.sent,e.next=10,this._.usersCache.get(a,n,i);case 10:if(p=e.sent,d=p.pgp_public_key,h=null,!d){e.next=23;break}return e.next=16,o.default.getCampaignInfo(a,l,t);case 16:if(!(_=e.sent)||!_.campaign){e.next=20;break}return y=new f.default({ponged:!0}),e.abrupt("return",y);case 20:h=new u.default("Campaign not found."),e.next=24;break;case 23:h=new u.default("PGP key not found.");case 24:throw new s.default(400,h);case 27:throw e.prev=27,e.t0=e.catch(4),new s.default(400,e.t0);case 30:case"end":return e.stop()}},e,this,[[4,27]])}));return function(){return e.apply(this,arguments)}}()},{key:"config",set:function(e){this._.config=e}}]),e}();t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEvents=o;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0));function o(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return n.default.createClient(e,t).request("\n    query getEvents($userCursor: String!, $after: String, $first: Int) {\n      events(user_cursor: $userCursor, after: $after, first: $first) {\n        data {\n          date_c\n          event_id\n          event_type\n          hmac\n          owner_cursor\n          payload\n          reference_cursor\n          reference_type\n        }\n        page_info {\n          end_cursor\n          has_next_page\n        }\n      }\n    }\n  ",{after:o,first:i,userCursor:r}).then(function(e){return e.events}).catch(function(e){throw n.default.transformError(e)})}t.default={getEvents:o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addEventSubscription=a,t.deleteEventSubscription=u,t.listEventSubscriptions=s;var n=i(r(1)),o=i(r(0));function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t,r,n){o.default.assertAppearsToBeACampaignId(n);var i=[];for(var a in r){var u=r[a],s=f(a);i.push({handler:u,event_type:s})}var c={campaign_cursor:n,events:i};return o.default.createClient(e,t).request("\n    mutation addEventSubscription($config: AddSubscriptionsConfig!) {\n      add_event_subscriptions(config: $config) {\n        data {\n          campaign_cursor\n          date_c\n          event_type\n          handler\n          owner_cursor\n        }\n        page_info {\n          end_cursor\n          has_next_page\n        }\n      }\n    }\n  ",{config:c}).then(function(e){return e.add_event_subscriptions}).catch(function(e){throw o.default.transformError(e)})}function u(e,t,r,n){o.default.assertAppearsToBeACampaignId(n);var i=[];for(var a in r){var u=f(a);i.push(u)}var s={campaign_cursor:n,events:i};return o.default.createClient(e,t).request("\n    mutation deleteEventSubscription($config: DeleteSubscriptionsConfig!) {\n      delete_event_subscriptions(config: $config) {\n        deleted_number\n      }\n    }\n  ",{config:s}).then(function(e){return e.delete_event_subscriptions}).catch(function(e){throw o.default.transformError(e)})}function s(e,t,r){o.default.assertAppearsToBeACampaignId(r);return o.default.createClient(e,t).request("\n    query listEventSubscriptions($campaignId: String!) {\n      event_subscriptions(campaign_cursor: $campaignId) {\n        data {\n          campaign_cursor\n          date_c\n          event_type\n          handler\n          owner_cursor\n        }\n        page_info {\n          end_cursor\n          has_next_page\n        }\n      }\n    }\n  ",{campaignId:r}).then(function(e){var t=e.event_subscriptions;return t.page_info=t.page_info||{end_cursor:null,has_next_page:!1},t}).catch(function(e){throw o.default.transformError(e)})}var c={BreachBeeUsed:"breach_bee_used",BreachPresented:"breach_presented",ConsentApproved:"consent_approved",ConsentChanged:"consent_changed",ConsentDeclined:"consent_declined",ConsentExpired:"consent_expired",ConsentNearExpiration:"consent_near_expiration",DataApproved:"data_approved",DataChanged:"data_changed",DataDeclined:"data_declined",DataExpired:"data_expired",DataNearExpiration:"data_near_expiration",UserDataRequest:"user_data_request",UserMessage:"user_message"};function f(e){if(!(e in c))throw new n.default('Invalid event type provided: "'+e+'".');return c[e]}t.default={addEventSubscription:a,deleteEventSubscription:u,listEventSubscriptions:s}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=s(r(14)),i=s(r(2)),a=s(r(4)),u=s(r(5));function s(e){return e&&e.__esModule?e:{default:e}}function c(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(o,i){try{var a=t[o](i),u=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}var f=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._={apiAccessTokenCache:r,config:t||null,usersCache:n}}return n(e,[{key:"_assertValidState",value:function(){if(!this._.config)throw TypeError("Illegal State: Default config has not been set yet.")}},{key:"getConversation",value:function(){var e=c(regeneratorRuntime.mark(function e(t){var r,n,i,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),r=function(){var e=c(regeneratorRuntime.mark(function e(t,r){var n,i,a,u,c,f,l,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.apiKey,i=t.apiSecret,a=t.apiUrlRoot,u=r.after,c=r.limit,f=r.targetCursor,e.next=4,s._.apiAccessTokenCache.get(a,n,i);case 4:return l=e.sent,e.next=7,o.default.getConversation(a,l,f,u,c);case 7:return p=e.sent,e.abrupt("return",p);case 9:case"end":return e.stop()}},e,s)}));return function(t,r){return e.apply(this,arguments)}}(),n=a.default.resolveApiCfg(l,this._.config),i={after:u,limit:f,targetCursor:t},e.abrupt("return",a.default.startPaging(r,n,i));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getConversations",value:function(){var e=c(regeneratorRuntime.mark(function e(){var t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,u=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),t=function(){var e=c(regeneratorRuntime.mark(function e(t,r){var n,i,a,s,c,f,l,p,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.apiKey,i=t.apiSecret,a=t.apiUrlRoot,s=r.after,c=r.limit,e.next=4,u._.apiAccessTokenCache.get(a,n,i);case 4:return f=e.sent,e.next=7,u._.usersCache.get(a,n,i);case 7:return l=e.sent,p=l.cursor,e.next=11,o.default.getConversations(a,f,p,s,c);case 11:return d=e.sent,e.abrupt("return",d);case 13:case"end":return e.stop()}},e,u)}));return function(t,r){return e.apply(this,arguments)}}(),r=a.default.resolveApiCfg(f,this._.config),n={after:i,limit:s},e.abrupt("return",a.default.startPaging(t,r,n));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getUser",value:function(){var e=c(regeneratorRuntime.mark(function e(){var t,r,n,o,s,c,f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),t=a.default.resolveApiCfg(f,this._.config),r=t.apiKey,n=t.apiSecret,o=t.apiUrlRoot,e.prev=3,e.next=6,this._.usersCache.get(o,r,n);case 6:return s=e.sent,c=new u.default({data:s}),e.abrupt("return",c);case 11:throw e.prev=11,e.t0=e.catch(3),new i.default(400,e.t0);case 14:case"end":return e.stop()}},e,this,[[3,11]])}));return function(){return e.apply(this,arguments)}}()},{key:"sendUserMessage",value:function(){var e=c(regeneratorRuntime.mark(function e(t,r,n){var s,c,f,l,p,d,h,_,y,v=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertValidState(),s=a.default.resolveApiCfg(v,this._.config),c=s.apiKey,f=s.apiSecret,l=s.apiUrlRoot,e.prev=3,e.next=6,this._.apiAccessTokenCache.get(l,c,f);case 6:return p=e.sent,e.next=9,this._.usersCache.get(l,c,f);case 9:return d=e.sent,h=d.cursor,e.next=13,o.default.sendUserMessage(l,p,t,h,r,n);case 13:return _=e.sent,y=new u.default({data:_}),e.abrupt("return",y);case 18:throw e.prev=18,e.t0=e.catch(3),new i.default(400,e.t0);case 21:case"end":return e.stop()}},e,this,[[3,18]])}));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"config",set:function(e){this._.config=e}}]),e}();t.default=f}]);