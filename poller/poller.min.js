var interval;function pollServer(e,t){var a=e;serverPollInt=setInterval(function(){a-=1,$("button").prop("disabled",!0),$(".xcoobee_clock").html("<p>next poll in <span>"+a+"</span> s</p>"),0==a&&(a=e,DisplayResponse(t))},1e3)}$(document).ready(function(){$("#xcoobee_demo_form").validate(),$("#stop_poll").on("click",function(){clearInterval(serverPollInt),$("#start_poll").removeClass("btn-default").addClass("btn-primary"),$("#stop_poll").removeClass("btn-primary").addClass("btn-default"),$("button").prop("disabled",!1),$(".xcoobee_clock").html("<p>waiting for poll</p>")})}),$.validator.addMethod("pollinterval",function(e,t){return 0==(e=$('input[name="'+t.name+'"]').val())||60<=e&&e<=600},"Enter interval in seconds 0 or min. 60 - max 600"),$.validator.setDefaults({submitHandler:function(){var e=$(this.submitButton).attr("name"),t=$("#post_url").val(),a=$("#xcoobee_poll_interval").val();return"start_poll"==e&&0!=a&&($("#start_poll").removeClass("btn-primary").addClass("btn-default"),$("#stop_poll").removeClass("btn-default").addClass("btn-primary"),DisplayResponse(t),pollServer(a,t)),"manual_poll"!=e&&0!=a||DisplayResponse(t),!1}});var DisplayResponse=function(a){$("button").prop("disabled",!0),$(".xcoobee_loader").show();var e=new XcooBee.sdk.Config({apiUrlRoot:$("#xcoobee_api_url").val(),apiKey:$("#xcoobee_api_key").val(),apiSecret:$("#xcoobee_api_secret").val()});new XcooBee.sdk.Sdk(e).system.getEvents().then(function(e){var t;e.result&&e.result&&e.result.data&&e.result.data.length?(e.result.data.forEach(function(e){t+="<tr>",t+="<td>"+StringToCamelCase(e.event_type)+"</td>",t+="<td>"+e.payload+"</td>",t+="<td>"+e.reference_type+"</td>",t+="<td>"+e.date_c+"</td>",t+="</tr>"}),$("#xcoobee_api_result tbody").html(t),a&&$.ajax({url:a,type:"POST",dataType:"json",data:e,contentType:"application/json"})):$("#xcoobee_api_result tbody").html("no running events");$(".xcoobee_loader").hide(),$("button").prop("disabled",!1)})},StringToCamelCase=function(e){return e.replace(/(\_\w)/g,function(e){return e[1].toUpperCase()})};